webpackJsonp([1],{"/NdZ":function(t,e){},"2ZiF":function(t,e,a){"use strict";var n=a("1tfL"),s=a("uSC2"),i=a("PGvq"),r=a("V88E"),o=a("pBi0"),l=a("qaXV"),c=a("bJ/5"),u=a("/tnA");s(s.S+s.F*!a("3Bg5")(function(t){Array.from(t)}),"Array",{from:function(t){var e,a,s,d,m=i(t),v="function"==typeof this?this:Array,p=arguments.length,f=p>1?arguments[1]:void 0,g=void 0!==f,h=0,_=u(m);if(g&&(f=n(f,p>2?arguments[2]:void 0,2)),void 0==_||v==Array&&o(_))for(a=new v(e=l(m.length));e>h;h++)c(a,h,g?f(m[h],h):m[h]);else for(d=_.call(m),a=new v;!(s=d.next()).done;h++)c(a,h,g?r(d,f,[s.value,h],!0):s.value);return a.length=h,a}})},IHPB:function(t,e,a){"use strict";e.__esModule=!0;var n,s=a("kfHR"),i=(n=s)&&n.__esModule?n:{default:n};e.default=function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return(0,i.default)(t)}},KYMQ:function(t,e,a){a("g5OY"),a("2ZiF"),t.exports=a("DH3n").Array.from},Z95Y:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("IHPB"),s=a.n(n),i=a("lC5x"),r=a.n(i),o=a("J0Oq"),l=a.n(o);var c=a("eAv8"),u={inject:["reload"],name:"SongDetails",data:function(){return{UserId:this.$store.state.userId,userToken:this.$store.state.userToken,cookie:this.$store.state.cookie,Songid:this.$route.query.id,data:this.$store.state.musicData,datalist:"",hotComments:"",textarea:"",currentData:"",that:this,AllComments:[],flag:"false",offset:0,loading:!1,total:""}},watch:{$route:function(t,e){this.$router.go(0),this.reload()}},filters:{filtrationTime:function(t,e){var a=new Date(t);return[a.getFullYear()+"年",e.zeroize(a.getMonth()+1)+"月",e.zeroize(a.getDate())+"日 ",e.zeroize(a.getHours())+":",e.zeroize(a.getMinutes())].join("")}},methods:{scrollHander:function(){var t,e,a,n;a=0,n=0,document.body&&(a=document.body.scrollHeight),document.documentElement&&(n=document.documentElement.scrollHeight),(a-n>0?a:n)==("CSS1Compat"===document.compatMode?document.documentElement.clientHeight:document.body.clientHeight)+(t=0,e=0,document.body&&(t=document.body.scrollTop),document.documentElement&&(e=document.documentElement.scrollTop),t-e>0?t:e)&&(this.loading=!0,this.getAllComment(this.Songid,this.offset))},setlike:function(t,e){return console.log(e),t++},zeroize:function(t){return t>10?t:"0"+t},getsongDetails:function(){var t=this;return l()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/song/detail?ids="+t.Songid);case 2:if(200===(a=e.sent).data.code){e.next=7;break}return e.abrupt("return",t.$message.error("获取歌曲详情失败！"));case 7:t.datalist=a.data.songs[0],console.log(a.data.songs[0].al.name);case 9:case"end":return e.stop()}},e,t)}))()},SendComment:function(t){var e=this;return l()(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.cookie){a.next=9;break}return a.next=3,e.$http.get("/comment?t=1&type=0&id="+e.Songid+"&content="+t+"&cookie="+e.cookie);case 3:n=a.sent,e.textarea="",e.AllComments.unshift(n.data.comment),e.total++,a.next=11;break;case 9:return e.$message.warning(" 请登录后再操作！"),a.abrupt("return",e.$router.push("/logInPage"));case 11:case"end":return a.stop()}},a,e)}))()},getHotComment:function(){var t=this;return l()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/comment/hot?id="+t.Songid+"&type=0");case 2:a=e.sent,t.hotComments=a.data.hotComments;case 4:case"end":return e.stop()}},e,t)}))()},getAllComment:function(t,e){var a=this;return l()(r.a.mark(function n(){var i,o;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.$http.get("/comment/music?id="+t+"&limit=50&offset="+e);case 2:o=n.sent,a.total=o.data.total,(i=a.AllComments).push.apply(i,s()(o.data.comments)),a.offset+=50,a.loading=!1;case 7:case"end":return n.stop()}},n,a)}))()},clickLike:function(t,e){if(!this.cookie)return this.$message.warning(" 请登录后再操作！"),this.$router.push("/login");e.target.getAttribute("data-islike")||(e.target.setAttribute("data-islike","1"),e.target.textContent=parseInt(e.target.textContent)+1,e.target.setAttribute("style","color: red"),this.$http.get("/comment/like?id="+this.Songid+"&cid="+t+"&t=1&type=0&cookie="+this.cookie))},playSong:function(t){var e=this;Object(c.a)(t).then(function(a){e.$bus.$emit("getMusicMessage",{musicdata:a,id:t});var n={picUrl:a.picUrl,Singer:a.Singer,picname:a.picname};e.$store.commit("setMusicData",n)})}},mounted:function(){this.getsongDetails()},created:function(){this.getHotComment(),this.getAllComment(this.Songid,this.offset),window.addEventListener("scroll",this.scrollHander),console.log("created")},destroyed:function(){window.removeEventListener("scroll",this.scrollHander)}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"SongDetails"},[a("el-row",{attrs:{gutter:0}},[a("el-col",{attrs:{xs:18,sm:18,md:18,lg:18,xl:12}},[a("div",{staticClass:"grid-content SDleft"},[a("div",{staticClass:"top"},[a("div",{staticClass:"top-left"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.datalist.al.picUrl+"?param=130y130",expression:"`${datalist.al.picUrl}?param=130y130`"}],attrs:{alt:""}})]),t._v(" "),a("div",{staticClass:"top-right"},[a("div",[a("span",{staticClass:"el-icon-loading"}),t._v(" "),a("span",{staticClass:"title"},[t._v(t._s(t.datalist.name))])]),t._v(" "),a("div",[t._v("歌手："+t._s(t.datalist.ar[0].name))]),t._v(" "),a("div",[t._v("所属专辑："+t._s(t.datalist.al.name))])]),t._v(" "),a("div",{staticClass:"top-right-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.playSong(t.Songid)}}},[t._v("播放"),a("i",{staticClass:"el-icon-video-play el-icon--right"})]),t._v(" "),a("el-button",{attrs:{type:"primary"}},[t._v("分享"),a("i",{staticClass:"el-icon-share el-icon--right"})]),t._v(" "),a("el-button",{attrs:{type:"primary"}},[t._v("收藏"),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1)]),t._v(" "),a("div",{staticClass:"bottom"},[a("div",{staticClass:"dec"},[a("span",[t._v("评论")]),t._v(" "),a("span",[t._v("共"),a("span",{staticClass:"commentTotal"},[t._v(t._s(t.total))]),t._v("条评论")])]),t._v(" "),a("div",{staticClass:"CommentInput"},[a("el-input",{staticClass:"inputbox",attrs:{type:"textarea",rows:3,placeholder:"请输入内容并按回车键发送",size:"350",maxlength:"350",resize:"none"},nativeOn:{keyup:function(e){return e.type.indexOf("key")||13===e.keyCode?t.SendComment(t.textarea):null}},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}})],1),t._v(" "),a("ul",{staticClass:"Commentarea"},[a("h3",[t._v("热门评论")]),t._v(" "),t._l(t.hotComments,function(e,n){return a("li",{key:n},[a("div",{staticClass:"Commentareabox"},[a("div",{staticClass:"pic"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.user.avatarUrl+"?param=50y50",expression:"item.user.avatarUrl + '?param=50y50'"}],attrs:{alt:""}})]),t._v(" "),a("div",{staticClass:"side"},[a("div",{staticClass:"CommentTitle"},[a("span",{staticClass:"nickname"},[t._v(t._s(e.user.nickname)+"：")]),t._v(" "),a("span",[t._v(t._s(e.content))])]),t._v(" "),a("div",{staticClass:"timerorlike"},[a("span",{staticClass:"timer"},[t._v(t._s(t._f("filtrationTime")(e.time,t.that)))]),t._v(" "),a("span",{staticClass:"My-new-icondianzan",on:{click:function(a){return t.clickLike(e.commentId,a)}}},[t._v(t._s(e.likedCount))]),t._v(" "),a("span",{staticClass:"vertical"},[t._v("|")]),t._v(" "),a("span",[t._v("回复")])])])])])})],2),t._v(" "),a("ul",{staticClass:"Commentarea"},[a("h3",[t._v("最新评论")]),t._v(" "),t._l(t.AllComments,function(e,n){return a("li",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],key:n},[a("div",{staticClass:"Commentareabox"},[a("div",{staticClass:"pic"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.user.avatarUrl+"?param=50y50",expression:"item.user.avatarUrl + '?param=50y50'"}],attrs:{alt:""}})]),t._v(" "),a("div",{staticClass:"side"},[a("div",{staticClass:"CommentTitle"},[a("span",{staticClass:"nickname"},[t._v(t._s(e.user.nickname)+"：")]),t._v(" "),a("span",[t._v(t._s(e.content))])]),t._v(" "),a("div",{staticClass:"timerorlike"},[a("span",{staticClass:"timer"},[t._v(t._s(t._f("filtrationTime")(e.time,t.that)))]),t._v(" "),a("span",{staticClass:"My-new-icondianzan",on:{click:function(a){return t.clickLike(e.commentId,a)}}},[t._v(t._s(e.likedCount))]),t._v(" "),a("span",{staticClass:"vertical"},[t._v("|")]),t._v(" "),a("span",[t._v("回复")])])])])])})],2)])])])],1),t._v(" "),a("router-view",{key:t.$route.fullPath})],1)},staticRenderFns:[]};var m=a("C7Lr")(u,d,!1,function(t){a("/NdZ")},"data-v-45174eeb",null);e.default=m.exports},"bJ/5":function(t,e,a){"use strict";var n=a("FIRb"),s=a("ZwTi");t.exports=function(t,e,a){e in t?n.f(t,e,s(0,a)):t[e]=a}},kfHR:function(t,e,a){t.exports={default:a("KYMQ"),__esModule:!0}}});
//# sourceMappingURL=1.03053f0d4b9b29c7362b.js.map